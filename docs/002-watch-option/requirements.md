# Requirements: --watch Option

## Problem Statement

現在の md-server は、Markdown ファイルを変更した際に、ブラウザを手動でリロードしなければ変更が反映されません。ユーザーは Markdown ファイルを編集しながらプレビューを確認したいというニーズがあり、変更を検出して自動的にブラウザをリロードする機能が必要です。

## Requirements

### Functional Requirements

1. **FR-1**: `--watch` オプションを CLI に追加する
2. **FR-2**: `--watch` オプションが有効な場合、指定されたディレクトリ内の Markdown ファイル (`.md`) の変更を監視する
3. **FR-3**: Markdown ファイルに変更が検出された場合、接続されているすべてのブラウザに自動リロードを通知する
4. **FR-4**: ファイルの追加・削除も検出し、ファイル一覧ページも自動更新する

### Non-Functional Requirements

1. **NFR-1**: ファイル監視には `chokidar` ライブラリを使用する（既に依存関係に追加済み）
2. **NFR-2**: ブラウザとの通信には Server-Sent Events (SSE) または WebSocket を使用する
3. **NFR-3**: 複数のブラウザタブが同時に接続されている場合、すべてのタブに通知する
4. **NFR-4**: ファイル変更後、100ms 以内にリロード通知を送信する

## Constraints

1. 既存の機能（`--port` オプション、Markdown ファイルの表示）に影響を与えない
2. `--watch` オプションが指定されていない場合、従来通りの動作をする
3. Node.js 18.0.0 以上で動作すること

## Acceptance Criteria

1. `mds --watch` コマンドでサーバーを起動し、Markdown ファイルを編集すると、ブラウザが自動的にリロードされる
2. `mds` コマンド（`--watch` なし）では、従来通りの動作をする
3. 複数のブラウザタブで同じページを開いている場合、すべてのタブが自動リロードされる
4. ファイルの追加・削除時にもファイル一覧ページが更新される

## User Stories

### US-1: Markdown プレビュー中の自動リロード

**As a** Markdown ドキュメントを執筆するユーザー
**I want to** ファイルを保存したときにブラウザが自動的にリロードされる
**So that** 手動でリロードする手間なく、変更をすぐに確認できる

### US-2: 新規ファイル追加時の自動更新

**As a** 複数の Markdown ファイルを管理するユーザー
**I want to** 新しいファイルを追加したときにファイル一覧が自動更新される
**So that** ファイル一覧ページを手動でリロードせずに新しいファイルにアクセスできる
